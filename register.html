<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Register â€” CandleScalpEA</title>
  <style>
    :root{
      --bg:#0b0f19;
      --panel:rgba(255,255,255,0.06);
      --text:rgba(255,255,255,0.92);
      --muted:rgba(255,255,255,0.70);
      --line:rgba(255,255,255,0.10);
      --accent:#7c3aed;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;color:var(--text);background:var(--bg)}
    .container{max-width:520px;margin:auto;padding:22px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:18px}
    input{
      width:100%;padding:11px;border-radius:12px;border:1px solid var(--line);
      background:#000;color:white;margin-top:10px
    }
    .btn{
      width:100%;margin-top:12px;padding:11px 14px;border-radius:12px;border:1px solid var(--line);
      background:rgba(124,58,237,.35);color:white;font-weight:900;cursor:pointer;
    }
    .link{display:inline-block;margin-top:12px;color:var(--muted);text-decoration:none}
    .msg{margin-top:10px;color:var(--muted);font-size:13px;min-height:18px}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h2 style="margin:0 0 8px">Register</h2>
      <div style="color:var(--muted);margin-bottom:6px">Create your account.</div>

      <input id="email" placeholder="Email" autocomplete="email"/>
      <input id="password" placeholder="Password (min 8 chars)" type="password" autocomplete="new-password"/>
      <input id="confirm" placeholder="Confirm Password" type="password" autocomplete="new-password"/>

      <button class="btn" id="btn">Create Account</button>
      <div class="msg" id="msg"></div>

      <a class="link" href="login.html">Already have an account? Login</a><br/>
      <a class="link" href="index.html">Back to home</a>
    </div>
  </div>

<script>
const API = "/api";

document.getElementById("btn").onclick = async () => {
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value;
  const confirm_password = document.getElementById("confirm").value;

  const msg = document.getElementById("msg");
  msg.textContent = "";

  const r = await fetch(API + "/auth/register", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    credentials:"include",
    body: JSON.stringify({ email, password, confirm_password })
  });

  const d = await r.json().catch(()=>({ok:false,reason:"bad_json"}));
  if(d.ok){
    location.href = "index.html";
    return;
  }

  msg.textContent = d.reason || "register_failed";
};
</script>
</body>
</html>
